<!-- inclusion of relatives functions -->
<script type="text/javascript" src="/scripts/js/tools.js" ></script>


	<button id="deploySignUpForm" type="button" class="btn btn-primary">Sign Up</button>



	{% if error_signup %}	<div class='form-group sign-up' style='display:block'>
	{% else %}	<div class='form-group sign-up' style='display:none'>
	{% endif %}
		<label for="name">Name</label>
		<input id="name" name="name" class="form-control" value="{{name}}">
	</div>


	{% if error_signup %}	<div class='form-group sign-up' style='display:block'>
	{% else %}	<div class='form-group sign-up' style='display:none'>
	{% endif %}
		<label for="firstName">Firstname</label>
		<input id="firstName" name="firstName" class="form-control" value="{{firstName}}">
	</div>


	{% if error_signup %}	<div class='form-group sign-up' style='display:block'>
	{% else %}	<div class='form-group sign-up' style='display:none'>
	{% endif %}
		<label for="nickName">Nickname *</label>
		<span id="error_notif_nick" style="font-size:25px; color:red; float:center">{{error_nick_msg}}</span>
		<input id="nickName" name="nickName" class="form-control" value="{{nickName}}">
	</div>


	{% if error_signup %}	<div class='form-group sign-up' style='display:block'>
	{% else %}	<div class='form-group sign-up' style='display:none'>
	{% endif %}
		<label for="emailInput">Email address *</label>
		<span id="error_notif_mail" style="font-size:25px; color:red; float:center">{{error_mail_msg}}</span>
		<input id="email" name="email" class="form-control" type="email" placeholder="Email" value="{{email}}">
	</div>


	{% if error_signup %}	<div class='form-group sign-up' style='display:block'>
	{% else %}	<div class='form-group sign-up' style='display:none'>
	{% endif %}
		<label for="password">Password</label>
		<span id="error_notif_pass" style="font-size:25px; color:red; float:center">{{error_pass_msg}}</span>
		<input id="passwordSignUp" name="passBasic" class="form-control" type="password" placeholder="Password" value="{{passBasic}}">
	</div>


	{% if error_signup %}	<div class='form-group sign-up' style='display:block'>
	{% else %}	<div class='form-group sign-up' style='display:none'>
	{% endif %}
		<label for="passValidate">Enter the chosen password again</label>
		<span id="error_notif_pass_confirm" style="font-size:25px; color:red; float:center">{{error_pass_confirm_msg}}</span>
		<input id="passValidate" name="passValidate" class="form-control" type="password" placeholder="Password" value="{{passValidate}}">
	</div>


	{% if error_signup %}	<div class='form-group sign-up' style='display:block'>
	{% else %}	<div class='form-group sign-up' style='display:none'>
	{% endif %}
		<button id="submitSignUpBtn" type="submit" class="btn btn-primary" onclick="submitSignUp();">Sign Up !!</button>
	</div>


<script>
$(document).ready(function(e){

	console.log("executed sign up");

	//sign Up Form management
	var deploySignUpForm = document.getElementById('deploySignUpForm');
	deploySignUpForm.onclick = function(){

		//Show/hide all forms
		var signUpClass = document.getElementsByClassName('form-group sign-up');
		for(i=0; i<signUpClass.length; i++){
			if(signUpClass[i].style.display !== 'none'){
				signUpClass[i].style.display = 'none';
				console.log("hide");
			}
			else{
				signUpClass[i].style.display = 'block';
				console.log("block !");
			}
		}

		//Invert text of button
		var textBtn = deploySignUpForm.firstChild;
		textBtn.data = textBtn.data == "Sign Up" ? "Close" : "Sign Up";
	};
});


function submitSignUp(){
	$.ajax({
	  type: "POST",
	  url: "/signUp",
	  dataType: 'json',
	  data: JSON.stringify({"name" : $("#name").val(),
							"firstName" : $("#firstName").val(),
							"nickName" : $("#nickName").val(),
							"email" : $("#email").val(),
							"is_email" : $(validateEmail($("#email").val())),
							"password" : $("#passwordSignUp").val(),
							"passValidate" : $("#passValidate").val()
							})
	})
	.done(function( data ) { 		
		console.log("data received back");

		if (data['error']){

			if (data['error_notif_nick']){
				document.getElementById("error_notif_nick").innerHTML = data['error_nick_msg'];
			}else{
				document.getElementById("error_notif_nick").innerHTML = "";
			}

			if (data['error_notif_mail']){
				document.getElementById("error_notif_mail").innerHTML = data['error_mail_msg'];				
			}else{
				document.getElementById("error_notif_mail").innerHTML = "";
			}

			if (data['error_notif_pass']){
				document.getElementById("error_notif_pass").innerHTML = data['error_pass_msg'];				
			}else{
				document.getElementById("error_notif_pass").innerHTML = "";
			}

			if (data['error_notif_pass_confirm']){
				document.getElementById("error_notif_pass_confirm").innerHTML = data['error_pass_confirm_msg'];	
			}else{
				document.getElementById("error_notif_pass_confirm").innerHTML = "";
			}

		}else{
			console.log("no error");
			window.location.replace("/");
		}
	});
};

</script>
