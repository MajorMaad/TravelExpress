<!DOCTYPE html>
<html>
<head>

	<!-- Bootstrap CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">

	<!-- JQuery -->
	<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>

	<!-- bootstrap JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>

	<!-- Our CSS -->
	<link rel="stylesheet" type="text/css" href="../scripts/main.css">
	<link rel="stylesheet" type="text/css" href="../scripts/listTravels.css">


	<title>TravelExpress</title>

</head>

<body>

	<!-- Temporary banner -->
	<div id="banner" class="page-header" >
		<h1>Travel Express <small> Travel where ever you want </small></h1>
	</div>

	{% if user %}

		<!-- Nav bar -->
		<ul class="nav nav-tabs nav-justified">
			<li>
				<a href="/">
					<span class="glyphicon glyphicon-home" aria-hidden="true"></span>
					Home
				</a>
			</li>

			<li class="dropdown active">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
					<span class="glyphicon glyphicon-sunglasses" aria-hidden="true"></span>
					Traveler <span class="caret"></span>
				</a>
				<ul class="dropdown-menu">
					<li><a href="/travelerTravels">Show my travels</a></li>
					<li role="separator" class="divider"></li>
					<li><a href="/searchTravel">Look for a travel</a></li>
				</ul>
			</li>

			<li class="dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">
					<span class="glyphicon glyphicon-road" aria-hidden="true"></span>
					Driver <span class="caret"></span>
				</a>
				<ul class="dropdown-menu">
					<li><a href="/driverTravels">Show my travels</a></li>
					<li role="separator" class="divider"></li>
					<li><a href="/addTravel">Add a travel</a></li>
				</ul>
			</li>

			<li>
				<a href="/logOut">
					<span class="glyphicon glyphicon-off" aria-hidden="true"></span>
					Log Out
				</a>
			</li>

		</ul>


		<!-- Body -->

		{% if travels.get() == None %}

			<div class="alert alert-warning" role="alert">
				<strong>Warning !</strong> No travels found ! <a href="/searchTravel">Try again</a>
			</div>

		{% endif %}

		<div id="resultSearch" class="container">
		{% for travel in travels %}

			{% if travel.places_remaining >= 0 %}

			<div class="panel panel-primary">
				<div class="panel-heading">
					<div class="row">
						<div class="col-md-6">
							<h3 class="panel-title"><strong>{{ travel.datetime_departure.strftime('%d /%m/%Y @ %H:%M') }} : </strong> {{ travel.departure|capitalize }} - {{ travel.arrival|capitalize }}</h3>
						</div>

						<form method="post" action="/addUserToTravel">

							<input type="hidden" name="travel_id" value="{{ travel.key().id() }}">

							<div class="plus-minus col-md-3">
								<button type="button" class="btn btn-default minus-btn">
									<span class="glyphicon glyphicon-minus"></span>
								</button>

								<input type="number" name="places_reservation" min="1" max="{{ travel.places_remaining }}" value="1">

								<button type="button" class="btn btn-default plus-btn">
									<span class="glyphicon glyphicon-plus"></span>
								</button>
							</div>


							<div class="btn-group col-md-2">
									<button type="submit" class="btn btn-success">
									<span class="glyphicon glyphicon-ok"></span>
									</button>
					        </div>

					     </form>

			        </div>
			    </div>

				<div class="panel-body">
					<p><strong>{{ travel.places_remaining }}</strong> places remaining</p>
					<div class="inline_panel">
						<p><strong>{{ travel.price }}$</strong></p>

						{% if travel.animal_ok %}
							<img src="../scripts/img/animal.jpg" alt="Animal OK">
						{% else %}
							<img src="../scripts/img/no_animal.jpg" alt="NO Animal">
						{% endif %}

						{% if travel.smoking_ok %}
							<img src="../scripts/img/smoking.jpg" alt="Smoking OK">
						{% else %}
							<img src="../scripts/img/no_smoking.jpg" alt="NO Smoking">
						{% endif %}

						{% if travel.big_luggage_ok %}
							<img src="../scripts/img/suitcase.jpg" alt="Suitcase">
						{% else %}
							<img src="../scripts/img/small_bag.jpg" alt="Small bag">
						{% endif %}
					</div>
				</div>
			</div>

			{% endif %}

		{% endfor %}
		</div>


	{% endif %}

	<script type="text/javascript">

	$(document).ready(function() {

		$('.btn-success').click(function() {

			return confirm('Are you sure you want to book this travel ?');

		});

		$('.plus-btn').click(function() {

			var $input = $(this).prev();
			var val = parseInt($input.val());
			var max_val = parseInt($input.attr('max'));

			val += 1;

			if (val <= max_val)
				$input.val(val);

		});


		$('.minus-btn').click(function() {

			var $input = $(this).next();
			var val = parseInt($input.val());
			var min_val = parseInt($input.attr('min'));

			val -= 1;

			if (val >= min_val)
				$input.val(val);

		});

	});

	</script>

</body>

</html>